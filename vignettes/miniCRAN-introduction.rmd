<!--
% \VignetteIndexEntry{Using miniCRAN to create a local CRAN repository}
% \VignetteEngine{knitr::knitr}
% \VignettePackage{miniCRAN}
% \VignetteKeyword{miniCRAN}
--> 

# Using miniCRAN to create a local CRAN repository

Start by creating the recursive dependency tree for your target packages.

For example, imagine a scenario where you want to create a repository that consists of the package `foreach` and its dependencies.
 
Start by creating the dependency list:

```{r make-repo-1}
library(miniCRAN)
# Specify list of packages to download
pkgs <- c("foreach")

revolution <- c(CRAN="http://cran.revolutionanalytics.com")
pkgList <- pkgDep(pkgs, repos=revolution, type="source", suggests = FALSE, )
pkgList
```

Next, create a repository with the function `makeRepo()`.  In this example, get the required files for `source` packages as well as windows binaries:


```{r make-repo-2}
# Create temporary folder for miniCRAN
dir.create(pth <- file.path(tempdir(), "miniCRAN"))

# Make repo for source and win.binary
makeRepo(pkgList, path=pth, repos=revolution, type="source")
makeRepo(pkgList, path=pth, repos=revolution, type="win.binary")
```


Investigate the repository file structure

```{r make-repo-3}
# List all files in miniCRAN
list.files(pth, recursive = TRUE, full.names = FALSE)
```


Use `pkgAvail` to list available packages in your repository:

```{r make-repo-4}
# Check for available packages
pkgAvail(repos=pth, type="win.binary")[, c(1:3, 5)]
```


Install pacakges from your local repository:

```{r make-repo-5}
install.packages(pkgs, 
                 repos = paste0("file:///", pth),
                 type = "source")
 ```


```{r make-repo-6, include=FALSE}
# Delete temporary folder
unlink(pth, recursive = TRUE)
```

